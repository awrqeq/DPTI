experiment:
  seed: 42
  device: auto  # "auto", "cuda", or "cpu"

data:
  name: cifar10        # 或 gtsrb / imagenette
  root: ./data
  img_size: 32         # gtsrb 用 64, imagenette 用 224
  batch_size: 128
  num_workers: 8
  target_class: 0
  marked_ratio: 0.1
  beta: 2.0
  pca_sample_blocks: 20000
  block_size: 4

  # 仅 imagenette 需要
  # train_root: /path/to/imagenette/train
  # test_root: /path/to/imagenette/val
model:
  name: resnet18    # 或 densenet121
  num_classes: 10      # GTSRB 是 43, imagenette 是 10

pca:
  k_tail: 4
  save_path: "./artifacts/freq_stats_cifar4.pkl"
  # mask 不设置时自动根据数据集 + block_size 生成

train:
  epochs: 200

  optimizer: "sgd"        # 或 "adam"
  lr: 0.1
  momentum: 0.9
  weight_decay: 0.0005

  scheduler: "cosine"     # 或 "none"
  eta_min: 0.0001
  amp: true
log:
  print_every: 50
  ckpt_dir: "./checkpoints"
  log_dir: "./logs"
